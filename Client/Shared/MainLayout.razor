@inherits LayoutComponentBase

<MudThemeProvider @ref="@_mudThemeProvider" @bind-IsDarkMode="@_isDarkMode" Theme="MyCustomTheme" />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
	<MudAppBar Elevation="0">
		<MudIconButton Icon="@Icons.Material.Filled.Menu" Edge="Edge.Start" OnClick="@((e) => DrawerToggle())" />
		<MudIconButton Icon="@GetIcon()" OnClick="@((e) => DarkModeToggle())" Class="mr-4" />
		<MudSpacer />
		<MudIconButton Icon="@Icons.Material.Filled.AttachMoney" Color="Color.Primary" />
		<MudText Class="ml-n2">1,928,458</MudText>
		<MudIconButton Icon="@Icons.Material.Filled.Diamond" Color="Color.Tertiary" />
		<MudText>18,348</MudText>
	</MudAppBar>
	<MudDrawer @bind-Open="_drawerOpen" Elevation="1">
		<MudDrawerHeader>
			<MudText Typo="Typo.h6">SimWars</MudText>
		</MudDrawerHeader>
		<NavMenu />
	</MudDrawer>
	<MudMainContent>
		<MudContainer MaxWidth="MaxWidth.Large" Class="my-2 pt-2">
			@Body
		</MudContainer>
	</MudMainContent>
</MudLayout>

@code {
	private bool _drawerOpen = true;
	private bool _isDarkMode = true;
	private MudThemeProvider? _mudThemeProvider;

	protected override async Task OnAfterRenderAsync(bool firstRender) {
		if (firstRender) {
			_isDarkMode = await _mudThemeProvider?.GetSystemPreference();
			StateHasChanged();
		}
	}

	string GetIcon() => _isDarkMode ? Icons.Material.Filled.LightMode : Icons.Material.Filled.DarkMode;

	void DrawerToggle() => _drawerOpen = !_drawerOpen;

	void DarkModeToggle() => _isDarkMode = !_isDarkMode;

	MudTheme MyCustomTheme = new MudTheme() {
			Palette = new Palette() {
				Primary = Colors.LightGreen.Accent4,
				Secondary = Colors.Amber.Accent2,
				Tertiary = Colors.Cyan.Accent3,
				AppbarBackground = null
			},
			PaletteDark = new PaletteDark() {
				Primary = Colors.LightGreen.Accent4,
				Secondary = Colors.Amber.Accent2,
				Tertiary = Colors.Cyan.Accent3
			},

			LayoutProperties = new LayoutProperties() {
				DrawerWidthLeft = "260px",
				DrawerWidthRight = "300px"
			}
		};

}